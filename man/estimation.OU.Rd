% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimation.OU.R
\name{estimation.OU}
\alias{estimation.OU}
\title{Estimate Parameters for the Factor OUSSM Model}
\usage{
estimation.OU(
  theta.off.diag.init,
  theta.diag.init,
  ytn.sim,
  N,
  sim.num,
  p.dim,
  m.dim,
  tn.diff,
  theta.off.diag,
  Z.par,
  H.diag,
  mu
)
}
\arguments{
\item{theta.off.diag.init}{A numeric vector representing the initial values
for the off-diagonal elements of the state transition matrix \code{Theta}.}

\item{theta.diag.init}{A numeric vector representing the initial values for
the diagonal elements of \code{Theta}.}

\item{ytn.sim}{A 3D array of dimensions \code{(N, p.dim, sim.num)} containing
the simulated observed data.}

\item{N}{An integer specifying the number of time points.}

\item{sim.num}{An integer specifying the number of simulation runs.}

\item{p.dim}{An integer specifying the number of observed variables.}

\item{m.dim}{An integer specifying the number of latent state variables.}

\item{tn.diff}{A numeric vector of length \code{N-1} representing the time
differences between consecutive observations.}

\item{theta.off.diag}{A numeric vector of the true off-diagonal elements of
\code{Theta} for comparison in confidence region calculations.}

\item{Z.par}{A numeric vector representing the true values of \code{Z}
for comparison in confidence region calculations.}

\item{H.diag}{A numeric vector representing the true diagonal elements of
\code{H} for comparison in confidence region calculations.}

\item{mu}{A numeric vector representing the true mean values for comparison.}
}
\value{
A list containing:
\item{theta.matrix.dist}{An array storing the estimated \code{Theta} matrices across simulations.}
\item{C.matrix.dist}{An array storing the estimated state transition matrices \code{C}.}
\item{Z.matrix.dist}{An array storing the estimated observation matrices \code{Z}.}
\item{H.matrix.dist}{An array storing the estimated observation noise covariance matrices \code{H}.}
\item{mu.dist}{A matrix storing the estimated mean vectors.}
\item{Hessian.record}{An array storing the Hessian matrices from optimization.}
\item{CRegion}{A vector containing the confidence region values for overall parameter estimation.}
\item{CRegion.theta}{A vector containing the confidence region values for \code{Theta} parameters.}
\item{L.dist}{A vector storing the log-likelihood values from optimization.}
\item{result.para.dist}{A matrix storing the estimated parameter values.}
}
\description{
This function estimates the parameters of the Factor Ornstein-Uhlenbeck
State-Space Model (OUSSM) using Maximum Likelihood Estimation (MLE). It
initializes parameters, runs the optimization using the Kalman filter, and
records the estimated parameter distributions.
}
\details{
The function follows these steps:
\itemize{
\item Initializes the parameters based on the covariance of the data.
\item Uses eigen decomposition to initialize the observation matrix \code{Z}.
\item Runs the \code{optim()} function with the \code{L-BFGS-B} method to estimate parameters.
\item Converts the estimated parameters into structured matrices using \code{para.to.model()}.
\item Ensures sign consistency using \code{convert.Z.theta()}.
\item Computes confidence regions based on the estimated Hessian matrices.
}
}
\examples{
# Example usage (assuming required parameters and simulated data are predefined)
result <- estimation.OU(theta.off.diag.init, theta.diag.init, ytn.sim, N, sim.num, 
                        p.dim, m.dim, tn.diff, theta.off.diag, Z.par, H.diag, mu)
result$theta.matrix.dist  # Access the estimated Theta matrices
}
